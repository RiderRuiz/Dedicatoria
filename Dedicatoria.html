<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ’– Â¡Nuestro Mes MÃ¡gico! ðŸ’–</title>
    <link rel="stylesheet" href="styles.css"> 
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/confetti-js@0.0.18/dist/index.min.js"></script>
</head>
<body>

    <audio id="background-music" loop>
        <source src="tu_cancion.mp3" type="audio/mpeg">
        Tu navegador no soporta el elemento de audio.
    </audio>

    <div class="background-animation"></div>

    <div id="intro-screen" class="intro-screen">
        <div class="letter-envelope" onclick="openLetter()">
            <div class="envelope-back"></div>
            <div class="envelope-flap"></div>
            <div class="envelope-content">
                <p class="intro-text">Tienes una carta especial...</p>
                <p class="click-prompt">ðŸ’– (Haz clic para abrir) ðŸ’–</p>
            </div>
            <div class="envelope-stamp pulse">âœ¨</div>
            <div class="envelope-front"></div>
        </div>
    </div>
    
    <div id="main-content" class="card hidden">
        <div class="heart-icon beat-animation">ðŸ’–</div>
        <h1 class="title slide-down">Â¡Feliz Mesiversario, Mi Amor!</h1>
        <p class="message typing-animation">
            Un mes mÃ¡s a tu lado es un capÃ­tulo hermoso en nuestra historia. <br>
            Gracias por cada risa, cada abrazo y cada momento mÃ¡gico. <br>
            Â¡Te amo con todo mi corazÃ³n!
        </p>
        <div class="polaroid-container">
            <div class="polaroid rotate-left">
                <img src="https://picsum.photos/200/200?random=1" alt="Nuestro Momento 1">
                <p>Nuestra primera cita</p>
            </div>
            <div class="polaroid rotate-right">
                <img src="https://picsum.photos/200/200?random=2" alt="Nuestro Momento 2">
                <p>Esa vez que reÃ­mos sin parar</p>
            </div>
        </div>
        <button class="confetti-button" onclick="triggerConfetti()">ðŸŽ‰ Â¡Celebremos! ðŸŽ‰</button>
        <p class="signature pulse">
            Con un amor infinito,
            <br>
            [Tu Nombre o Apodo CariÃ±oso]
        </p>
        <p class="date">
            17 de Noviembre, 2025
        </p>
    </div>

    <canvas id="confetti-canvas" class="confetti-canvas"></canvas>

    <script>
        const card = document.getElementById('main-content');
        const intro = document.getElementById('intro-screen');
        const music = document.getElementById('background-music');

        function typeWriterEffect() {
            const messageElement = document.querySelector('.message');
            // Usamos innerHTML para incluir el <br>
            const originalText = messageElement.innerHTML; 
            messageElement.innerHTML = '';
            let i = 0;
            const speed = 50;

            function typeWriter() {
                if (i < originalText.length) {
                    if (originalText.substring(i, i + 4) === '<br>') {
                        messageElement.innerHTML += '<br>';
                        i += 4; // Salta los 4 caracteres de <br>
                    } else {
                        messageElement.innerHTML += originalText.charAt(i);
                        i++;
                    }
                    setTimeout(typeWriter, speed);
                }
            }
            typeWriter();
        }

        function openLetter() {
            // Oculta la intro
            intro.classList.add('hide-intro');
            // Activa la animaciÃ³n de apertura de la solapa
            document.querySelector('.envelope-flap').classList.add('open');

            setTimeout(() => {
                // Muestra la tarjeta principal
                card.classList.remove('hidden');
                card.classList.add('fade-in');
                
                // Inicia la mÃºsica
                music.play().catch(error => {
                    console.log("Error al reproducir la mÃºsica: ", error);
                });
                
                // Inicia el efecto de escritura
                setTimeout(typeWriterEffect, 1000); 
                
                // Oculta completamente la intro despuÃ©s de la transiciÃ³n
                intro.style.display = 'none';
            }, 800); 
        }

        function triggerConfetti() {
            // ConfiguraciÃ³n del confeti mÃ¡s grande y denso
            var confettiSettings = { 
                target: 'confetti-canvas', 
                max: 150, 
                size: 1.8, 
                props: ['circle', 'square', 'line'], 
                colors: [[165,104,246],[230,61,135],[0,199,228],[255,255,255]], 
                respawn: true 
            };
            var confetti = new ConfettiGenerator(confettiSettings);
            confetti.render();
            // Lo limpia despuÃ©s de 5 segundos
            setTimeout(() => {
                confetti.clear();
            }, 5000); 
        }
    </script>
</body>
</html>